"use strict";(self.webpackChunkfreshcart=self.webpackChunkfreshcart||[]).push([[77],{3077:(T,a,c)=>{c.r(a),c.d(a,{ForgotpasswordComponent:()=>Z});var p=c(6814),r=c(95),t=c(4769),u=c(9862);let m=(()=>{class o{constructor(s){this._HttpClient=s,this.basUrl="https://ecommerce.routemisr.com/api/v1/auth/"}forgotPassword(s){return this._HttpClient.post(this.basUrl+"forgotPasswords",s)}resetCode(s){return this._HttpClient.post(this.basUrl+"verifyResetCode",s)}resetPassword(s){return this._HttpClient.put(this.basUrl+"resetPassword",s)}static#t=this.\u0275fac=function(e){return new(e||o)(t.LFG(u.eN))};static#s=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var g=c(1120);function l(o,i){if(1&o&&(t.TgZ(0,"p",7),t._uU(1),t.qZA()),2&o){const s=t.oxw(2);t.xp6(1),t.Oqu(s.successMsg)}}function d(o,i){if(1&o&&(t.TgZ(0,"p",8),t._uU(1),t.qZA()),2&o){const s=t.oxw(2);t.xp6(1),t.Oqu(s.errorMsg)}}function f(o,i){if(1&o){const s=t.EpF();t.TgZ(0,"section",1),t.NdJ("ngSubmit",function(){t.CHM(s);const n=t.oxw();return t.KtG(n.forgotPassword())}),t.TgZ(1,"form")(2,"label",2),t._uU(3,"email"),t.qZA(),t._UZ(4,"input",3),t.TgZ(5,"button",4),t._uU(6,"Send"),t.qZA()(),t.YNc(7,l,2,1,"p",5),t.YNc(8,d,2,1,"p",6),t.qZA()}if(2&o){const s=t.oxw();t.Q6J("formGroup",s.forgotForm),t.xp6(7),t.Q6J("ngIf",s.successMsg),t.xp6(1),t.Q6J("ngIf",s.errorMsg)}}function _(o,i){if(1&o&&(t.TgZ(0,"p",7),t._uU(1),t.qZA()),2&o){const s=t.oxw(2);t.xp6(1),t.Oqu(s.successMsg)}}function w(o,i){if(1&o&&(t.TgZ(0,"p",8),t._uU(1),t.qZA()),2&o){const s=t.oxw(2);t.xp6(1),t.Oqu(s.errorMsg)}}function h(o,i){if(1&o){const s=t.EpF();t.TgZ(0,"section",1),t.NdJ("ngSubmit",function(){t.CHM(s);const n=t.oxw();return t.KtG(n.resetCode())}),t.TgZ(1,"form")(2,"label",9),t._uU(3,"reset code"),t.qZA(),t._UZ(4,"input",10),t.TgZ(5,"button",4),t._uU(6,"Send"),t.qZA()(),t.YNc(7,_,2,1,"p",5),t.YNc(8,w,2,1,"p",6),t.qZA()}if(2&o){const s=t.oxw();t.Q6J("formGroup",s.resetCodeForm),t.xp6(7),t.Q6J("ngIf",s.successMsg),t.xp6(1),t.Q6J("ngIf",s.errorMsg)}}function x(o,i){if(1&o&&(t.TgZ(0,"p",7),t._uU(1),t.qZA()),2&o){const s=t.oxw(2);t.xp6(1),t.Oqu(s.successMsg)}}function C(o,i){if(1&o&&(t.TgZ(0,"p",8),t._uU(1),t.qZA()),2&o){const s=t.oxw(2);t.xp6(1),t.Oqu(s.errorMsg)}}function F(o,i){if(1&o){const s=t.EpF();t.TgZ(0,"section",1),t.NdJ("ngSubmit",function(){t.CHM(s);const n=t.oxw();return t.KtG(n.newPassword())}),t.TgZ(1,"form")(2,"label",11),t._uU(3,"new password"),t.qZA(),t._UZ(4,"input",12),t.TgZ(5,"button",4),t._uU(6,"Reset Password"),t.qZA()(),t.YNc(7,x,2,1,"p",5),t.YNc(8,C,2,1,"p",6),t.qZA()}if(2&o){const s=t.oxw();t.Q6J("formGroup",s.resetPasswordForm),t.xp6(7),t.Q6J("ngIf",s.successMsg),t.xp6(1),t.Q6J("ngIf",s.errorMsg)}}let Z=(()=>{class o{constructor(s,e){this._ForgotpasswordService=s,this._Router=e,this.step1=!0,this.step2=!1,this.step3=!1,this.userEmail="",this.successMsg="",this.errorMsg="",this.forgotForm=new r.cw({email:new r.NI("",[r.kI.required,r.kI.email])}),this.resetCodeForm=new r.cw({resetCode:new r.NI("",[r.kI.required])}),this.resetPasswordForm=new r.cw({newPassword:new r.NI("",[r.kI.required,r.kI.pattern(/^[a-zA-Z0-9_@]{6,}$/)])})}forgotPassword(){let s=this.forgotForm.value;this.userEmail=s.email,this._ForgotpasswordService.forgotPassword(s).subscribe({next:e=>{this.errorMsg="",this.successMsg=e.message,this.step1=!1,this.step2=!0},error:e=>{this.errorMsg=e.error.message}})}resetCode(){this._ForgotpasswordService.resetCode(this.resetCodeForm.value).subscribe({next:e=>{this.errorMsg="",this.successMsg="Your code is correct",this.step2=!1,this.step3=!0},error:e=>{this.successMsg="",this.errorMsg=e.error.message}})}newPassword(){let s=this.resetPasswordForm.value;console.log("password object from the first : ",s),s.email=this.userEmail,this._ForgotpasswordService.resetPassword(s).subscribe({next:e=>{e.token&&(localStorage.setItem("userToken",e.token),this._Router.navigate(["/home"]))},error:e=>{this.successMsg="",this.errorMsg=e.error.message}})}static#t=this.\u0275fac=function(e){return new(e||o)(t.Y36(m),t.Y36(g.F0))};static#s=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-forgotpassword"]],standalone:!0,features:[t.jDz],decls:3,vars:3,consts:[["class","w-50 p-3 bg-main-light rounded shadow mx-auto mt-4",3,"formGroup","ngSubmit",4,"ngIf"],[1,"w-50","p-3","bg-main-light","rounded","shadow","mx-auto","mt-4",3,"formGroup","ngSubmit"],["for","email"],["formControlName","email","type","email","id","email",1,"form-control"],[1,"w-100","main-btn","mt-3"],["class","alert alert-success mb-0",4,"ngIf"],["class","alert alert-danger mb-0",4,"ngIf"],[1,"alert","alert-success","mb-0"],[1,"alert","alert-danger","mb-0"],["for","resetCode"],["formControlName","resetCode","type","text","id","resetCode",1,"form-control"],["for","resetPassword"],["formControlName","newPassword","type","password","id","resetPassword",1,"form-control"]],template:function(e,n){1&e&&(t.YNc(0,f,9,3,"section",0),t.YNc(1,h,9,3,"section",0),t.YNc(2,F,9,3,"section",0)),2&e&&(t.Q6J("ngIf",n.step1),t.xp6(1),t.Q6J("ngIf",n.step2),t.xp6(1),t.Q6J("ngIf",n.step3))},dependencies:[p.ez,p.O5,r.UX,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u]})}return o})()}}]);